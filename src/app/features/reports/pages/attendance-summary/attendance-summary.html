<main class="main-container">
  <h1 class="font-bold text-2xl mt-4 print:-mx-4">
    LTHMI Recto Manila - 
    <span class="text-monochromatic-dark">Weekly Attendance Summary</span>
  </h1>

  <div class="print:hidden mt-2 space-x-4">
    <mat-form-field appearance="outline" class="w-full md:w-72">
      <mat-label>MMMM DD, YYYY</mat-label>
      <input matInput [matDatepicker]="dp" [formControl]="date">
      <mat-datepicker-toggle matIconSuffix [for]="dp"></mat-datepicker-toggle>
      <mat-datepicker #dp></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline" class="w-full md:w-72">
      <mat-label>Select</mat-label>
      <mat-select [(ngModel)]="selectedValue">
        <mat-option value="Sunday Service">Sunday Service</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <h2 class="hidden print:block text-xl font-semibold text-text-300 mb-2 -mx-4">{{ date.value.toDate() | date: 'mediumDate' }} - {{selectedValue}}</h2>
  
  <table class="w-full md:w-3/5 print:w-full print:-mx-4 border-2 border-monochromatic-base shadow-default border-collapse">
    <thead class="text-xl font-normal rounded-3xl">
      <tr>
        <th class="text-left px-4 py-3 font-bold">Member Status</th>
        <th class="text-right px-4 py-3 font-bold">Attendees</th> 
      </tr>
    </thead>
    
    <tbody>
      @if (isAttendanceSummaryLoading) {
        <app-report-skeleton></app-report-skeleton>
      }

      @if (!isAttendanceSummaryEmpty && !isAttendanceSummaryLoading) {
        <tr class="border">
          <th colspan="2" class="px-4 py-1 bg-monochromatic-dark font-bold text-left">
            Attendees
          </th>
        </tr>
        @for (category of regularAttendees; track category.name) {
          <tr class="border">
            <td class="px-4 py-1">{{category.name}}</td>
            <td class="px-4 py-1 flex gap-2 justify-end items-center">
              <span>{{category.count}}</span>
              <lucide-angular class="w-4 h-4" [img]="Users"></lucide-angular>
            </td>
          </tr>
        }
        <tr class="border">
          <td class="px-4 py-1 font-bold">TOTAL</td>
          <td class="px-4 py-1 font-bold flex gap-2 justify-end items-center">
            <span>{{totalRegulars}}</span>
            <lucide-angular class="w-4 h-4" [img]="Users"></lucide-angular>
          </td>
        </tr>

        <tr class="border">
          <th colspan="2" class="px-4 py-1 bg-monochromatic-dark font-bold text-left">
            VIPs
          </th>
        </tr>
        @for (category of vipAttendees; track category.name) {
          <tr class="border">
            <td class="px-4 py-1" >{{category.name}}</td>
            <td class="px-4 py-1 flex gap-2 justify-end items-center">
              <span>{{category.count}}</span>
              <lucide-angular class="w-4 h-4" [img]="Users"></lucide-angular>
            </td>
          </tr>
        }
        <tr class="border">
          <td class="px-4 py-1 font-bold">TOTAL</td>
          <td class="px-4 py-1 font-bold flex gap-2 justify-end items-center">
            <span>{{totalVips}}</span>
            <lucide-angular class="w-4 h-4" [img]="Users"></lucide-angular>
          </td>
        </tr>
      }
    </tbody>
  </table>

  @if (isAttendanceSummaryEmpty && !isAttendanceSummaryLoading) {
  <div class="w-3/5 mt-4">
    <app-error-card
      [statusCode]="204"
      title="Content Not Found"
      message="No attendance records found for this date."
      imageUrl="/assets/http.cat/204.jpeg"
    ></app-error-card>
  </div>
  }
</main>